<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game_hall</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/game_hall.css">
</head>
<body>
    <div class="nav">Gobang</div>
    <!-- 整个页面的容器元素 -->
    <div class="container">
        <!-- 这个div 在container 中是处于垂直水平居中这样的位置 -->
        <div>
            <!-- 展示用户信息 -->
            <div id="screen"></div>
            <!-- 按钮匹配，第一次点击，开始匹配，再点一下，文本就改成停止匹配 -->
            <div id="match-button">开始匹配</div>
        </div>
    </div>

    <script src="js/jquery.min.js"></script>
    <script>
        // 页面加载的时候，发送的请求。
        $.ajax({
            type: 'get',
            url: '/userInfo',
            success: function(body) {
                // 获取screen这个标签
                let screenDiv = document.querySelector('#screen');
                screenDiv.innerHTML = '玩家：' + body.username + '   分数：' + body.score 
                    + '<br> 比赛场次：' + body.totalCount + '   获胜场数：' + body.winCount
            },
            error: function() {
                alert("获取用户信息失败！");
            }
        });

        // 此处进行初始化 websocket,并且实现前端的匹配逻辑
        // 此处的的路径必须写成 /findMatch , Not /findMatch/
        let websocket = new WebSocket('ws://127.0.0.0:8080/findMatch');
        websocket.onopen = function() {
            console.log("onOpen");
        }
        websocket.onclose = function() {
            console.log("onClose");
        }
        websocket.onerror = function() {
            console.log("onError");
        }
        
        // 监听页面关闭事件，在页面关闭之前，手动调用这里的 websocket 的close 方法。
        // 告诉server，用户退出了。
        window.onbeforeunload = function() {
            websocket.close();

        }
        // 重点实现的方法，要处理服务器返回的响应
        websocket.onmessage = function() {
            
        }
    </script>
</body>
</html>